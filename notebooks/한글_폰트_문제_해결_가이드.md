# 🔧 Colab에서 한글 깨짐 문제 해결 가이드

## 📌 문제 원인

### 왜 로컬 PC에서는 잘 보이는데 Colab에서는 깨질까요?

1. **로컬 PC (Windows)**
   - `C:\Windows\Fonts\malgun.ttf` (맑은 고딕) 등 한글 폰트가 기본 설치되어 있음
   - PIL/Pillow와 matplotlib이 자동으로 한글 폰트를 찾아 사용함

2. **Google Colab (Linux)**
   - 기본적으로 한글 폰트가 설치되어 있지 않음
   - matplotlib이 한글을 지원하지 않아 □□□로 표시됨
   - PIL/Pillow는 폰트 경로를 직접 지정하면 사용 가능

## ✅ 해결 방법

### 1. 나눔 폰트 설치 (Colab 환경)

```python
# 한글 폰트 설치 및 설정 (Colab용)
!apt-get install -y fonts-nanum fonts-nanum-coding fonts-nanum-extra
!fc-cache -fv

# matplotlib 한글 폰트 설정
import matplotlib.pyplot as plt
import matplotlib.font_manager as fm

font_path = '/usr/share/fonts/truetype/nanum/NanumGothic.ttf'
fontprop = fm.FontProperties(fname=font_path, size=10)
plt.rc('font', family=fontprop.get_name())
plt.rc('axes', unicode_minus=False)  # 마이너스 기호 깨짐 방지

print("✅ 한글 폰트 설정 완료!")
```

### 2. PIL/Pillow에서 폰트 사용 (이미지 생성 시)

노트북의 기존 코드는 이미 Windows/Linux 호환 폰트 로드 로직이 포함되어 있습니다:

```python
from PIL import Image, ImageDraw, ImageFont

# 한글 폰트 로드 (Windows/Linux 호환)
try:
    font = ImageFont.truetype("C:\\Windows\\Fonts\\malgun.ttf", 20)
except:
    try:
        font = ImageFont.truetype("/usr/share/fonts/truetype/nanum/NanumGothic.ttf", 20)
    except:
        font = ImageFont.load_default()

# 이미지에 한글 텍스트 추가
img = Image.new('RGB', (600, 200), color='white')
draw = ImageDraw.Draw(img)
draw.text((20, 20), "안녕하세요 Document AI", fill='black', font=font)
img.save('test.jpg')
```

## 📝 적용된 노트북

다음 노트북들에 한글 폰트 설정 셀이 추가되었습니다:

1. **Lab01_개발환경구축.ipynb** - 환경 검증 및 테스트 이미지 생성
2. **Lab03_PaddleOCR.ipynb** - matplotlib 시각화
3. **Lab04_OCR엔진비교.ipynb** - 성능 비교 차트
4. **Lab05_신뢰도측정.ipynb** - 신뢰도 분포 히스토그램
5. **Lab06_이미지전처리.ipynb** - 전처리 전후 비교
6. **Lab07_앙상블.ipynb** - 앙상블 결과 시각화
7. **Lab08_표검출.ipynb** - 표 검출 시각화
8. **Lab09_NER정보추출.ipynb** - 정보 추출 결과
9. **Lab10_토이프로젝트.ipynb** - 통합 프로젝트
10. **Lab11_전체테스트.ipynb** - 전체 시스템 테스트

## 🎯 사용 방법

### Colab에서 실행 순서

1. **첫 번째 셀**: 패키지 설치
2. **두 번째 셀**: **한글 폰트 설치 및 설정** ⭐ (새로 추가된 셀)
3. 나머지 셀들 순서대로 실행

### 주의사항

- 한글 폰트 설정 셀은 **노트북당 한 번만** 실행하면 됩니다
- 런타임을 다시 시작하면 다시 실행해야 합니다
- 로컬 PC에서는 이 셀을 실행하지 않아도 됩니다 (자동으로 Windows 폰트 사용)

## 🔍 세부 설명

### matplotlib.rc() 설정

```python
plt.rc('font', family=fontprop.get_name())  # 기본 폰트를 나눔고딕으로 설정
plt.rc('axes', unicode_minus=False)         # 마이너스 기호 깨짐 방지
```

이 설정으로 모든 matplotlib 차트(제목, 레이블, 범례 등)에 한글이 정상적으로 표시됩니다.

### 설치되는 폰트

- **NanumGothic**: 나눔고딕 (기본)
- **NanumGothicBold**: 나눔고딕 볼드
- **NanumGothicCoding**: 나눔고딕 코딩
- 경로: `/usr/share/fonts/truetype/nanum/`

## 🎨 결과 확인

### 성공적으로 적용되면:

- ✅ matplotlib 차트의 한글 제목/레이블이 정상 표시
- ✅ PIL로 생성한 이미지의 한글이 정상 표시
- ✅ 히스토그램, 그래프 등 모든 시각화에서 한글 사용 가능

### 문제가 지속되면:

1. 런타임을 다시 시작하고 처음부터 실행
2. `fc-cache -fv` 명령이 제대로 실행되었는지 확인
3. 폰트 경로가 올바른지 확인: `!ls /usr/share/fonts/truetype/nanum/`

## 📚 참고 자료

- [Google Colab 한글 폰트 가이드](https://colab.research.google.com/notebooks/snippets/advanced_outputs.ipynb)
- [matplotlib 한글 사용법](https://matplotlib.org/stable/tutorials/text/text_props.html)
- [나눔 폰트 공식 사이트](https://hangeul.naver.com/font)

---

**작성일**: 2025-10-15  
**작성자**: Document AI Lecture  
**Repository**: https://github.com/leecks1119/document_ai_lecture

